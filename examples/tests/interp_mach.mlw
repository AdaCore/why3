module Int63Test

  use mach.int.Int63

  let t1 (): int63 = 1

  let t2 () = 2:int63

  let t3 () =
    let x:int63 = 1 in
    x

  let t4 () =
    let x:int63 = 1 in
    x + 2

  let t5 () =
    let x:int63 = 1 in
    x - 2

  let t6 () =
    let x = 10 in
    x + 2

  let t7 () =
    let x:int = 10 in
    Int.(-) x 2

  let t8 () =
    let x = 20 in
    let y = 21 in
    x < y

  let t9 () =
    let x = 20 in
    let y = 21 in
    x >= y

  let t10 () =
    let x = 20 in
    let y = 21 in
    x >= y - 1

  let t11 () =
    let x = 20 in
    let y = 21 in
    x = y - 1 && x >= y - 1 && y > x

  let t12 () =
    let x = 42 in
    x % 2 = 0

  let t13 () =
    let x = 42 in
    let y = 24 in
    let z = x + y / 2 in
    let w = z * x in
    let w = w % 10 in
    let w = -w in
    w = -8

  let t14 () =
    let x:int63 = of_int(42:int) in
    let y:int = to_int x in
    x + of_int y

  let t15 () = Int.(+) max_int63 min_int63

  (* let t16 () = zero + one + max_int + min_int *)

end

module Int31Test

  use mach.int.Int31

  let t1 (): int31 = 1

  let t2 () = 2:int31

  let t3 () =
    let x:int31 = 1 in
    x

  let t4 () =
    let x:int31 = 1 in
    x + 2

  let t5 () =
    let x:int31 = 1 in
    x - 2

  let t6 () =
    let x = 10 in
    x + 2

  let t7 () =
    let x:int = 10 in
    Int.(-) x 2

  let t8 () =
    let x = 20 in
    let y = 21 in
    x < y

  let t9 () =
    let x = 20 in
    let y = 21 in
    x >= y

  let t10 () =
    let x = 20 in
    let y = 21 in
    x >= y - 1

  let t11 () =
    let x = 20 in
    let y = 21 in
    x = y - 1 && x >= y - 1 && y > x

  let t12 () =
    let x = 42 in
    x % 2 = 0

  let t13 () =
    let x = 42 in
    let y = 24 in
    let z = x + y / 2 in
    let w = z * x in
    let w = w % 10 in
    let w = -w in
    w = -8

  let t14 () =
    let x:int31 = of_int(42:int) in
    let y:int = to_int x in
    x + of_int y

  let t15 () = Int.(+) max_int31 min_int31

  (* let t16 () = zero + one + max_int + min_int *)

end

module ByteTest

  use mach.int.Byte

  let t1 (): byte = 1

  let t2 () = 2:byte

  let t3 () =
    let x:byte = 1 in
    x

  let t4 () =
    let x:byte = 1 in
    x + 2

  let t5 () =
    let x:byte = 1 in
    x - 2

  let t6 () =
    let x = 10 in
    x + 2

  let t7 () =
    let x:int = 10 in
    Int.(-) x 2

  let t8 () =
    let x = 20 in
    let y = 21 in
    x < y

  let t9 () =
    let x = 20 in
    let y = 21 in
    x >= y

  let t10 () =
    let x = 20 in
    let y = 21 in
    x >= y - 1

  let t11 () =
    let x = 20 in
    let y = 21 in
    x = y - 1 && x >= y - 1 && y > x

  let t12 () =
    let x = 42 in
    x % 2 = 0

  let t13 () =
    let x = 42 in
    let y = 24 in
    let z = x + y / 2 in
    let w = z * x in
    let w = w % 10 in
    w = 8

  let t14 () =
    let x:byte = of_int(42:int) in
    let y:int = to_int x in
    x + of_int y

  let t15 () = Int.(+) max_byte min_byte

  (* let t16 () = zero + one + max_int + min_int *)

end

module TestArrays

  use array.Array

  let t1 () = empty ()

  let t2 () = make 10 1

end

module TestArgs

  use export int.Int
  use export ref.Ref

  let t1 x = x + 1

  let c = ref 1

  let t2 () = !c + 1

  let t3 () = c := 52

  let t4 () = c := !c + 1

  let t5 x = c := !c + x

end