(* This file is generated by Why3's Coq driver *)
(* Beware! Only edit allowed sections below    *)
Require Import BuiltIn.
Require BuiltIn.
Require int.Int.
Require int.Abs.
Require int.ComputerDivision.
Require list.List.
Require list.Length.
Require list.Nth.
Require option.Option.

(* Why3 assumption *)
Definition unit := unit.

Axiom qtmark : Type.
Parameter qtmark_WhyType : WhyType qtmark.
Existing Instance qtmark_WhyType.

(* Why3 assumption *)
Inductive ral
  (a:Type) :=
  | Empty : ral a
  | Zero : (ral (a* a)%type) -> ral a
  | One : a -> (ral (a* a)%type) -> ral a.
Axiom ral_WhyType : forall (a:Type) {a_WT:WhyType a}, WhyType (ral a).
Existing Instance ral_WhyType.
Implicit Arguments Empty [[a]].
Implicit Arguments Zero [[a]].
Implicit Arguments One [[a]].

(* Why3 assumption *)
Fixpoint flatten {a:Type} {a_WT:WhyType a} (l:(list (a*
  a)%type)) {struct l}: (list a) :=
  match l with
  | Init.Datatypes.nil => Init.Datatypes.nil
  | (Init.Datatypes.cons (x, y) l1) =>
      (Init.Datatypes.cons x (Init.Datatypes.cons y (flatten l1)))
  end.

(* Why3 goal *)
Theorem length_flatten : forall {a:Type} {a_WT:WhyType a},
  forall (l:(list (a* a)%type)),
  ((list.Length.length (flatten l)) = (2%Z * (list.Length.length l))%Z).
intros a a_WT l.
induction l.
auto.
simpl (flatten (a0::l)).
destruct a0.
replace (Length.length ((a0,a1)::l))
   with (1 + (Length.length l))%Z by auto.
unfold Length.length at 1; fold Length.length.
rewrite IHl.
ring.
Qed.

