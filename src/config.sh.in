#!/bin/sh

config=src/util/config.ml
makefileconfig=share/Makefile.config

bindir="\"$BINDIR\""
libdir="\"$LIBDIR/why3\""
datadir="\"$DATADIR/why3\""
localdir="None"
libobjdir="(Sys.getcwd ())"

if [ "@enable_relocation@" = "yes" ]; then
    libdir='Filename.concat (Filename.concat (Filename.dirname
        (Filename.dirname Sys.executable_name)) "lib") "why3"'
    datadir='Filename.concat (Filename.concat (Filename.dirname
        (Filename.dirname Sys.executable_name)) "share") "why3"'
    localdir="None"
elif [ "@enable_local@" = "yes" ]; then
    bindir="\"@LOCALDIR@/bin\""
    libdir="\"@LOCALDIR@/lib\""
    datadir="\"@LOCALDIR@/share\""
    localdir="Some \"@LOCALDIR@\""
fi

echo "
let version   = \"@VERSION@\"

let libdir    = $libdir
let datadir   = $datadir
let localdir  = $localdir

let libobjdir = $libobjdir

let enable_ide = \"@enable_ide@\"
let enable_zarith = \"@enable_zarith@\"
let enable_zip = \"@enable_zip@\"
let enable_coq_libs = \"@enable_coq_libs@\"
let enable_coq_fp_libs = \"@enable_coq_fp_libs@\"
let enable_pvs_libs = \"@enable_pvs_libs@\"
let enable_isabelle_libs = \"@enable_isabelle_libs@\"
let enable_hypothesis_selection = \"@enable_hypothesis_selection@\"
let enable_local = \"@enable_local@\"
let enable_relocation = \"@enable_relocation@\"
" > $config

echo "
OCAMLBEST   = @OCAMLBEST@
BIGINTLIB   = @BIGINTLIB@
MPFRLIB     = @MLMPFR@
INCLUDE     = @BIGINTINCLUDE@ -I \"$ocamllib\"
INCLUDEALL  = @BIGINTINCLUDE@ @ZIPINCLUDE@ @MENHIRINCLUDE@ -I \"$ocamllib\"
" > $makefileconfig

if [ "@enable_relocation@" = "no" ]; then

echo "
BINDIR      = $bindir
LIBDIR      = $libdir
DATADIR     = $datadir
" >> $makefileconfig

fi
