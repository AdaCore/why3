
module M

  use import module ref.Ref

  let test (x: ref int) =
    { !x = 0 }
    !x
    { result = 0 }

  (* BUG *)
  (* 
  let foo (a: ref int) = let x = a in fun () -> {} x := 0 { !x = 0 }
  let test () = let x = ref 0 in begin foo x (); assert { !x = 0 } end 
  *)  

end

(***
module TestArray

  use import int.Int
  use import module array.Array

  (* TODO: update *)
  let f (x: array int) =
    { x.length = 2 }
    x[0] <- 1;
    x[1] <- 2
    { x[1] = 2 and x.length = 2 }

end
***)

(*
Local Variables:
compile-command: "unset LANG; make -C .. testl-ide"
End:
*)
