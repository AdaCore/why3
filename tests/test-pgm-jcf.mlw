
module P

  use import programs.Prelude
  use import int.Int
  
  use export module stdlib.Ref

  let incr (r : ref int) : unit =
    { }
    set r (get r + 1)
    { r = old r + 1 }

  parameter r : ref int

  let foo (x : int) = 
    { x = 1 }
    if x = 1 || absurd then 2 else 3
    { result = 2 }

  let f (r : ref int) =
    { r = 0 }
    assert { r = 0 };
    incr r;
    get r
    { result = 1 }

end

(*
Local Variables: 
compile-command: "unset LANG; make -C .. testl-ide"
End: 
*)
