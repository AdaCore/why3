
module P

  use import programs.Prelude
  use import int.Int
  
  use export module stdlib.Ref

  let incr (r : ref int) : unit =
    { }
    r := !r + 1
    { r = old r + 1 }

  parameter r : ref int

  let rec (!!) (x : ref int) = 
    { x>=0 } if !x > 0 then  begin x := !x - 1; !! x end { x=0 }

  let test (r : ref int) =
    { r = 0 }
    assert { r = 0 };
    incr r;
    !r
    { result = 1 }

end

(*
Local Variables: 
compile-command: "unset LANG; make -C .. testl-ide"
End: 
*)
