module P

  use import int.Int
  use import module stdlib.Ref

  parameter r : ref int
  parameter fresh : unit -> {} unit writes r { r = old r + 1 }

  let rec f () =
    {}
    if any bool then
      fresh ()
    else begin
      f (); f ()
    end
    { r > old r }

  exception Exit int

  let foo () =
    {} 
    let x = ref 0 in
    do 
      x := !x + 1;
      if !x = 100 then raise (Exit !x)
    done
    { false } | Exit -> { result = 100 }

end


(*
Local Variables: 
compile-command: "unset LANG; make -C .. testl-ide"
End: 
*)
