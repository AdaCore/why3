module M

use import int.Int
use import module ref.Ref

parameter x : ref int

parameter f : unit -> { } unit writes x { !x = 1 - old !x }

let p () =
  begin
    label Init:
    let t = () in ();
    (f ());
    (f ());
    assert { !x = at !x Init };
    ()
  end

end

(*
Local Variables:
compile-command: "unset LANG; make -C ../../.. bench/programs/good/wpcalls"
End:
*)

